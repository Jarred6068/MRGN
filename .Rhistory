dodge=0.05,
return.means=FALSE,
rplot=4,
nplot=1,
save.plot=FALSE,
plot.path="")
#all models across Minor allele frequency
plot.sim.metrics(metrics.mrgn=mrgn.metrics,
metrics.mrpc=mrpc.metrics,
params=params,
which.param=4,
by.class=FALSE,
which.class=NULL,
plot.it=TRUE,
spline.it=TRUE,
spline.int=20,
dodge=0.05,
return.means=FALSE,
rplot=4,
nplot=1,
save.plot=FALSE,
plot.path="")
#all models across signal
plot.sim.metrics(metrics.mrgn=mrgn.metrics,
metrics.mrpc=mrpc.metrics,
params=params,
which.param=5,
by.class=FALSE,
which.class=NULL,
plot.it=TRUE,
spline.it=TRUE,
spline.int=10,
dodge=0.05,
return.means=FALSE,
rplot=4,
nplot=1,
save.plot=FALSE,
plot.path="")
##############################################
get.avg=function(x.mrgn=NULL, x.mrpc=NULL, params=NULL, which.param=2){
#sort unique simulation parameter values
x=sort(unique(params[,which.param]))
#preallocate
x.mean.mrgn=as.data.frame(matrix(0, nrow = length(x), ncol = 9))
x.mean.mrpc=as.data.frame(matrix(0, nrow = length(x), ncol = 9))
colnames(x.mean.mrgn)=c("param.value","precision","recall","specificity","FOR", "se.prec",
"se.recall","se.specif","se_FOR")
colnames(x.mean.mrpc)=c("param.value","precision","recall","specificity","FOR", "se.prec",
"se.recall","se.specif","se_FOR")
#calculate mean across signal values
for(i in 1:length(x)){
#calc means and sdevs for mrgn (remove method and inf columns)
x.mean.mrgn[i,1]=x[i]
if(length(which(params[,which.param]==x[i]))==1){
x.mean.mrgn[i,2:5]=x.mrgn[which(params[,which.param]==x[i]),-c(1:3)]
x.mean.mrgn[i,6:9]=rep(NA, 4)
}else{
x.mean.mrgn[i,2:5]=apply(x.mrgn[which(params[,which.param]==x[i]),-c(1:3)], 2, mean, na.rm=TRUE)
x.mean.mrgn[i,6:9]=apply(x.mrgn[which(params[,which.param]==x[i]),-c(1:3)], 2, sd, na.rm=TRUE)
}
#calc means and sdevs for mrpc (remove method and inf columns)
x.mean.mrpc[i,1]=x[i]
if(length(which(params[,which.param]==x[i]))==1){
x.mean.mrpc[i,2:5]=x.mrpc[which(params[,which.param]==x[i]),-c(1:3)]
x.mean.mrpc[i,6:9]=rep(NA, 4)
}else{
x.mean.mrpc[i,2:5]=apply(x.mrpc[which(params[,which.param]==x[i]),-c(1:3)], 2, mean, na.rm=TRUE)
x.mean.mrpc[i,6:9]=apply(x.mrpc[which(params[,which.param]==x[i]),-c(1:3)], 2, sd, na.rm=TRUE)
}
}
#bind for plotting
all.means.x=rbind.data.frame(cbind.data.frame(Method=rep("MRGN", length(x)), x.mean.mrgn),
cbind.data.frame(Method=rep("MRPC", length(x)), x.mean.mrpc))
return(all.means.x)
}
##############################################
plot.spline=function(Data=NULL, pd=NULL, spline.int=NULL, params=NULL, which.param=NULL, rplot=4, nplot=1){
#precision
A=ggplot(data=Data, aes(x=param.value, y=precision, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
stat_smooth(n=spline.int)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean Precision")
#Recall
B=ggplot(data=Data, aes(x=param.value, y=recall, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
stat_smooth(n=spline.int)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean Recall")
#Specificity
C=ggplot(data=Data, aes(x=param.value, y=specificity, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
stat_smooth(n=spline.int)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean Specificity")
#F1
D=ggplot(data=Data, aes(x=param.value, y=FOR, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
stat_smooth(n=spline.int)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean FOR")
#Combine
Z=ggarrange(A,B,C,D, labels=c("A","B","C","D"), nrow=rplot, ncol=nplot)
plot(Z)
}
##############################################
plot.regular=function(Data=NULL, pd=NULL, params=NULL, which.param=NULL, rplot=4, nplot=1){
#Precision
A=ggplot(data=Data, aes(x=param.value, y=precision, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean Precision")
#Recall
B=ggplot(data=Data, aes(x=param.value, y=recall, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean Recall")
#Specificity
C=ggplot(data=Data, aes(x=param.value, y=specificity, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean Specificity")
#F1
D=ggplot(data=Data, aes(x=param.value, y=FOR, color=Method))+
geom_line(position = pd)+
geom_point(position = pd)+
xlab(paste0(colnames(params)[which.param]))+
ylab("Mean FOR")
#Combine
Z=ggarrange(A,B,C,D, labels=c("A","B","C","D"), nrow=rplot, ncol=nplot)
plot(Z)
}
##############################################
plot.sim.metrics=function(metrics.mrgn=NULL, metrics.mrpc=NULL, params=NULL, which.param=2, by.class=FALSE,
which.class=NULL, plot.it=TRUE, spline.it=TRUE, spline.int=10, dodge=0.1,
return.means=TRUE, rplot=4, nplot=1, save.plot=FALSE, plot.path=""){
library(ggpubr)
pd=position_dodge(dodge)
if(by.class==TRUE){
#calc averages within a certain model class
metrics.mrgn.m=subset(metrics.mrgn, truth==which.class)
metrics.mrpc.m=subset(metrics.mrpc, truth==which.class)
#get mean scores across parameter within class
avg.scores.all=get.avg(x.mrgn = metrics.mrgn.m,
x.mrpc = metrics.mrpc.m,
params = params,
which.param = which.param)
}else{
#get mean scores across parameter
avg.scores.all=get.avg(x.mrgn = metrics.mrgn,
x.mrpc = metrics.mrpc,
params = params,
which.param = which.param)
}
#plotting - splined plots
if(plot.it==TRUE & spline.it==TRUE){
#for plot saving
if(save.plot==TRUE){
png(plot.path)
plot.spline(avg.scores.all,
pd = pd,
spline.int = spline.int,
params = params,
which.param = which.param,
rplot = rplot,
nplot = nplot)
dev.off()
}else{
plot.spline(avg.scores.all,
pd = pd,
spline.int = spline.int,
params = params,
which.param = which.param,
rplot = rplot,
nplot = nplot)
}
#plotting - regular plots
}else if(plot.it==TRUE & spline.it==FALSE){
if(save.plot==TRUE){
png(plot.path)
plot.regular(Data = avg.scores.all,
pd = pd,
params = params,
which.param = which.param,
rplot = rplot,
nplot = nplot)
dev.off()
}else{
plot.regular(Data = avg.scores.all,
pd = pd,
params = params,
which.param = which.param,
rplot = rplot,
nplot = nplot)
}
}
#return mean score and sdev data
if(return.means==TRUE){
return(avg.scores.all)
}
}
library(MRGN)
library(knitr)
small.datasets.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrgn_1k_datasets_wpc2small.RData")
small.reg.res.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrgn_1k_regres_results_wpc2small.RData")
small.inf.mods.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrgn_1k_inf_results_wpc2small.RData")
small.mrpc.inf.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrpc_1k_small_results_wpc2small.RData")
small.params.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrpc_v_mrgn_1k_params_wpc2small.RData")
small.mrpc.inf=lapply(small.mrpc.inf.wpc, function(x,i) x[[i]], i=1)
small.mrpc.adj=lapply(small.mrpc.inf.wpc, function(x,i) x[[i]], i=2)
model.truth.sm=convert.truth(small.params.wpc$model)
small.inf.cats=convert.cats(small.inf.mods.wpc)
small.mrpc.inf.cats=convert.cats(unlist(small.mrpc.inf))
kable(table(Truth=model.truth.sm, Inferred=small.inf.cats), caption = "Confusion matrix showing the performance of MRGN in inferring models M0 and M1 in the presence of confounding variables in scenario 2")
kable(table(Truth=model.truth.sm, Inferred=small.mrpc.inf.cats), caption = "Confusion matrix showing the performance of MRPC in inferring models M0 and M1 in the presence of confounding variables scenario 2")
small.mrgn.metrics.wpc=as.data.frame(matrix(0, nrow = 1000, ncol = 4))
small.mrpc.metrics.wpc=as.data.frame(matrix(0, nrow = 1000, ncol = 4))
colnames(small.mrgn.metrics.wpc)=c("prec_edge", "recall", "specificity", "FOR")
colnames(small.mrpc.metrics.wpc)=c("prec_edge", "recall", "specificity", "FOR")
for(i in 1:1000){
small.mrgn.metrics.wpc[i,]=get.metrics(Truth = model.truth.sm[i],
Inferred = small.inf.mods.wpc[i],
reg.vec = small.reg.res.wpc[,i],
get.adj.inf = TRUE,
get.adj.truth = TRUE)
small.mrpc.metrics.wpc[i,]=get.metrics(Truth = model.truth.sm[i],
Inferred = small.mrpc.adj[[i]],
get.adj.inf = FALSE,
get.adj.truth = TRUE)
}
small.mrgn.metrics.wpc=cbind.data.frame(Method=rep("MRGN",1000), truth=model.truth.sm, inf=small.inf.cats,
small.mrgn.metrics.wpc)
small.mrpc.metrics.wpc=cbind.data.frame(Method=rep("MRPC",1000), truth=model.truth.sm, inf=small.mrpc.inf.cats,
small.mrpc.metrics.wpc)
#calculate performance across confounders
# num.conf=unique(small.params.wpc$number.of.conf)
# mean.met.conf.mrgn=as.data.frame(matrix(0, nrow = length(num.conf), ncol = 4))
# mean.met.conf.mrpc=as.data.frame(matrix(0, nrow = length(num.conf), ncol = 4))
# for(i in 1:length(num.conf)){
#
# }
plot.sim.metrics(metrics.mrgn=small.mrgn.metrics.wpc,
metrics.mrpc=small.mrpc.metrics.wpc,
params=small.params.wpc,
which.param=6,
by.class=FALSE,
which.class=NULL,
plot.it=TRUE,
spline.it=TRUE,
spline.int=2,
dodge=0.1,
return.means=FALSE,
rplot=4,
nplot=1,
save.plot=FALSE,
plot.path="")
plot.sim.metrics(metrics.mrgn=small.mrgn.metrics.wpc,
metrics.mrpc=small.mrpc.metrics.wpc,
params=small.params.wpc,
which.param=6,
by.class=FALSE,
which.class=NULL,
plot.it=TRUE,
spline.it=TRUE,
spline.int=3,
dodge=0.1,
return.means=FALSE,
rplot=4,
nplot=1,
save.plot=FALSE,
plot.path="")
kable(cbind.data.frame(MRGN=colMeans(small.mrgn.metrics.wpc), MRPC=colMeans(small.mrpc.metrics.wpc)))
small.datasets.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrgn_1k_datasets_wpc2small.RData")
small.reg.res.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrgn_1k_regres_results_wpc2small.RData")
small.inf.mods.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrgn_1k_inf_results_wpc2small.RData")
small.mrpc.inf.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrpc_1k_small_results_wpc2small.RData")
small.params.wpc=loadRData(fileName = "C:/Users/Bruin/Documents/GitHub/MRGN_extra/Simulations/Sim_wPC_result_data/mrpc_v_mrgn_1k_params_wpc2small.RData")
small.mrpc.inf=lapply(small.mrpc.inf.wpc, function(x,i) x[[i]], i=1)
small.mrpc.adj=lapply(small.mrpc.inf.wpc, function(x,i) x[[i]], i=2)
model.truth.sm=convert.truth(small.params.wpc$model)
small.inf.cats=convert.cats(small.inf.mods.wpc)
small.mrpc.inf.cats=convert.cats(unlist(small.mrpc.inf))
kable(table(Truth=model.truth.sm, Inferred=small.inf.cats), caption = "Confusion matrix showing the performance of MRGN in inferring models M0 and M1 in the presence of confounding variables in scenario 2")
kable(table(Truth=model.truth.sm, Inferred=small.mrpc.inf.cats), caption = "Confusion matrix showing the performance of MRPC in inferring models M0 and M1 in the presence of confounding variables scenario 2")
small.mrgn.metrics.wpc=as.data.frame(matrix(0, nrow = 1000, ncol = 4))
small.mrpc.metrics.wpc=as.data.frame(matrix(0, nrow = 1000, ncol = 4))
colnames(small.mrgn.metrics.wpc)=c("prec_edge", "recall", "specificity", "FOR")
colnames(small.mrpc.metrics.wpc)=c("prec_edge", "recall", "specificity", "FOR")
for(i in 1:1000){
small.mrgn.metrics.wpc[i,]=get.metrics(Truth = model.truth.sm[i],
Inferred = small.inf.mods.wpc[i],
reg.vec = small.reg.res.wpc[,i],
get.adj.inf = TRUE,
get.adj.truth = TRUE)
small.mrpc.metrics.wpc[i,]=get.metrics(Truth = model.truth.sm[i],
Inferred = small.mrpc.adj[[i]],
get.adj.inf = FALSE,
get.adj.truth = TRUE)
}
kable(cbind.data.frame(MRGN=colMeans(small.mrgn.metrics.wpc), MRPC=colMeans(small.mrpc.metrics.wpc)))
kable(cbind.data.frame(MRGN=colMeans(small.mrgn.metrics.wpc), MRPC=colMeans(small.mrpc.metrics.wpc, na.rm = TRUE)))
library(FactoMineR)
?princomp
?prcomp
sh=read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg_AGTTC_out.genes.results",)
sh=read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg_AGTTC_out.genes.results",header = T, sep = "\t")
sh[which(sh$TPM)>0]
sh[,which(sh$TPM>0)]
sh[which(sh$TPM>0),]
TMP.sig=sh[which(sh$TPM>0),]
TPM.sig=sh[which(sh$TPM>0),]
rm(TMP.sig)
TPM.sig=sh[which(sh$TPM>0.5),]
hist(sh$TPM)
hist(log(sh$TPM))
log(100)
TPM.sig=sh[which(log(sh$TPM)>2),]
library(ggforce)
library(ggpubr)
?ggboxplot
9+15+30+9+15
library(readxl)
combined_results <- read_excel("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.xls")
View(combined_results)
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t")
comb[sort(rowMeans(comb[,-1])),]
head(comb)
comb[sort(rowMeans(comb[-1,-1])),]
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
head(comb)
comb[sort(rowMeans(comb[-1,-1])),]
comb[sort(rowMeans(comb[-1,])),]
head(comb)
str(comb)
comb[sort(rowMeans(comb[,-1])),]
comb.sort=comb[sort(rowMeans(comb[,-1])),]
comb.sort=comb[sort(rowMeans(comb[,-1]))$ix,]
?sort
comb.sort=comb[sort(rowMeans(comb[,-1]), index.return=T)$ix,]
comb
comb.sort=cbind.data.frame(comb[sort(rowMeans(comb[,-1]), index.return=T)$ix,1], rowMeans(comb[,-1])[sort(rowMeans(comb[,-1]), index.return=T)$ix]
)
head(comb.sort)
comb.sort=cbind.data.frame(comb[sort(rowMeans(comb[,-1]), index.return=T, decreasing = T)$ix,1], rowMeans(comb[,-1])[sort(rowMeans(comb[,-1]), index.return=T, decreasing = T)$ix]
)
head(comb.sort)
comb.sort[19,]
comb$Mean=rowMeans(comb[,-1])
head(comb)
comb=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb.sub=comb[which(comb$Mean>100),]
comb.sub$mean.non.preg=rowMeans(comb.sub[,c(2:7)])
comb.sub$mean.preg=rowMeans(comb.sub[,c(8:13)])
head(comb.sub)
comb.sub$fold.change=comb.sub$mean.preg/comb.sub$mean.non.preg
head(comb.sub)
comb.sub$log.change=log2(comb.sub$fold.change)
hist(comb.sub$fold.change)
log2(-10)
e^-10
exp(-10)
head(comb.sub)
comb.sort.log=comb.sub[sort(comb.sub$log.change, index.return=T, deacreasing = F),]
comb.sort.log=comb.sub[sort(comb.sub$log.change, index.return=T, decreasing = F),]
comb.sort.log=comb.sub[sort(comb.sub$log.change, index.return=T, decreasing = F)$ix,]
head(comb.sort.log)
exp(-Inf)
comb.sort.log=comb.sub[sort(comb.sub$log.change, index.return=T, decreasing = T)$ix,]
head(comb.sort.log)
exp(Inf)
comb.sig=comb.sort.log[which(comb.sort.log$log.change>1),]
head(comb.sig)
log2(0)
log2(1)
log2(10000)
log2(100000000000000000000000000)
log2(.0000001)
log2(-1)
x=seq(0, 1000, 0.01)
plot(x, log2(x))
x=seq(0, 10000, 0.1)
plot(x, log2(x))
comb.sub
comb.sig
log2(292)
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, return.index=T, decreasing = T),]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, return.index=T, decreasing = T),]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, return.index=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb.sig.diff=comb[which(comb$log.fold>1),]
comb.sig.diff.sort=comb.sig.diff[sort(comb.sig.diff$log.fold, index.return=T, decreasing = T),]
comb.sig.diff.sort=comb.sig.diff[sort(comb.sig.diff$log.fold, index.return=T, decreasing = T)$ix,]
head(comb.sig.diff.sort)
1/0
comb.sig.diff.sort=comb.sig.diff.sort[-which(comb.sig.diff.sort$log.fold==Inf),]
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb.sig.diff.up=comb[which(comb$log.fold>1),]
comb.sig.diff.sort1=comb.sig.diff.up[sort(comb.sig.diff.up$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort1=comb.sig.diff.sort1[-which(comb.sig.diff.sort1$log.fold==Inf),]
comb.sig.diff.down=comb[which(comb$log.fold<-1),]
comb.sig.diff.sort2=comb.sig.diff.down[sort(comb.sig.diff.down$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort2=comb.sig.diff.sort2[-which(comb.sig.diff.sort2$log.fold==-Inf),]
write.table(comb.sig.diff.sort1$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
header=F, row.names = F, sep="\t")
write.table(comb.sig.diff.sort2$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
header=F, row.names = F, sep = "\t")
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb.sig.diff.up=comb[which(comb$log.fold>1),]
comb.sig.diff.sort1=comb.sig.diff.up[sort(comb.sig.diff.up$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort1=comb.sig.diff.sort1[-which(comb.sig.diff.sort1$log.fold==Inf),]
comb.sig.diff.down=comb[which(comb$log.fold<-1),]
comb.sig.diff.sort2=comb.sig.diff.down[sort(comb.sig.diff.down$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort2=comb.sig.diff.sort2[-which(comb.sig.diff.sort2$log.fold==-Inf),]
write.table(comb.sig.diff.sort1$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
row.names = F, sep="\t")
write.table(comb.sig.diff.sort2$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
row.names = F, sep = "\t")
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb.sig.diff.up=comb[which(comb$log.fold>1),]
comb.sig.diff.sort1=comb.sig.diff.up[sort(comb.sig.diff.up$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort1=comb.sig.diff.sort1[-which(comb.sig.diff.sort1$log.fold==Inf),]
comb.sig.diff.down=comb[which(comb$log.fold< -1),]
comb.sig.diff.sort2=comb.sig.diff.down[sort(comb.sig.diff.down$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort2=comb.sig.diff.sort2[-which(comb.sig.diff.sort2$log.fold==-Inf),]
write.table(comb.sig.diff.sort1$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
row.names = F, sep="\t")
write.table(comb.sig.diff.sort2$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
row.names = F, sep = "\t")
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb.sig.diff.up=comb[which(comb$log.fold>1),]
comb.sig.diff.sort1=comb.sig.diff.up[sort(comb.sig.diff.up$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort1=comb.sig.diff.sort1[-which(comb.sig.diff.sort1$log.fold==Inf),]
comb.sig.diff.down=comb[which(comb$log.fold< -1),]
comb.sig.diff.sort2=comb.sig.diff.down[sort(comb.sig.diff.down$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort2=comb.sig.diff.sort2[-which(comb.sig.diff.sort2$log.fold==-Inf),]
write.table(comb.sig.diff.sort1$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
row.names = F, sep="\t")
write.table(comb.sig.diff.sort2$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.downreg.txt",
row.names = F, sep = "\t")
comb <- read.table("C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/combined_results.txt", sep="\t", header = T)
comb$Mean=rowMeans(comb[,-1])
comb.sort=comb[sort(comb$Mean, index.return=T, decreasing = T)$ix,]
comb$non.preg.mean=rowMeans(comb[,2:7])
comb$preg.mean=rowMeans(comb[,8:13])
comb$fold.change=comb$preg.mean/comb$non.preg.mean
comb$log.fold=log2(comb$fold.change)
comb.sig.diff.up=comb[which(comb$log.fold>1),]
comb.sig.diff.sort1=comb.sig.diff.up[sort(comb.sig.diff.up$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort1=comb.sig.diff.sort1[-which(comb.sig.diff.sort1$log.fold==Inf),]
comb.sig.diff.down=comb[which(comb$log.fold< -1),]
comb.sig.diff.sort2=comb.sig.diff.down[sort(comb.sig.diff.down$log.fold, index.return=T, decreasing = T)$ix,]
comb.sig.diff.sort2=comb.sig.diff.sort2[-which(comb.sig.diff.sort2$log.fold==-Inf),]
write.table(comb.sig.diff.sort1$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.upreg.txt",
row.names = F, col.names = F, sep="\t")
write.table(comb.sig.diff.sort2$gene_id, file = "C:/Users/Bruin/Desktop/GS Academia/PhD/SEM 2 SPRING 2022/BIOL 444/week12/preg.downreg.txt",
row.names = F, col.names = F, sep = "\t")
getwd()
